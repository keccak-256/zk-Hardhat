

import "hashes/sha256/512bitPacked" as sha256packed;

def  verifyUser(field[2] h,field h0, field h1,field pub)->field{
  assert(h[0] == h0);
  assert(h[1] == h1);
  return pub;
}
def main(private field cnic, private field privKey,  field pubKey, private field optional,  field h0,  field h1, field bit)->field{
  field[2] h = sha256packed([cnic, privKey, pubKey, optional]);
 return if bit == 0{
 pubKey
 }else{

 verifyUser(h,h0,h1,pubKey)
 };
  

}